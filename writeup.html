<html>
<head><meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<style type="text/css">
<!--
span.cls_002{font-family:Arial,serif;font-size:17.3px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_002{font-family:Arial,serif;font-size:17.3px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_003{font-family:Arial,serif;font-size:12.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_003{font-family:Arial,serif;font-size:12.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_004{font-family:Arial,serif;font-size:10.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_004{font-family:Arial,serif;font-size:10.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_005{font-family:Arial,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_005{font-family:Arial,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
-->
</style>
<script type="text/javascript" src="10a4fa4e-3278-11ec-a980-0cc47a792c0a_id_10a4fa4e-3278-11ec-a980-0cc47a792c0a_files/wz_jsgraphics.js"></script>
</head>
<body>
<div style="position:absolute;left:50%;margin-left:-306px;top:0px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="10a4fa4e-3278-11ec-a980-0cc47a792c0a_id_10a4fa4e-3278-11ec-a980-0cc47a792c0a_files/background1.jpg" width=612 height=792></div>
<div style="position:absolute;left:184.54px;top:55.94px" class="cls_002"><span class="cls_002">Deep Learning Final Project</span></div>
<div style="position:absolute;left:131.17px;top:92.08px" class="cls_003"><span class="cls_003">Jesse A. Comer — Mingni H. Cui — Omar Faruqi — Tan Xian Wei</span></div>
<div style="position:absolute;left:61.20px;top:128.64px" class="cls_003"><span class="cls_003">1</span></div>
<div style="position:absolute;left:81.37px;top:128.64px" class="cls_003"><span class="cls_003">Introduction</span></div>
<div style="position:absolute;left:61.20px;top:157.31px" class="cls_004"><span class="cls_004">We present a vision & controller solution that, in local testing, yielded an average of 1-1 goals per game against</span></div>
<div style="position:absolute;left:61.20px;top:172.14px" class="cls_004"><span class="cls_004">AI, and in the August 8th tournament, we scored 1.75 goals on average against AI. Videos of one of our most</span></div>
<div style="position:absolute;left:61.20px;top:186.35px" class="cls_004"><span class="cls_004">successful 1000-steps games against AI is included in writeup: agent0.mp4</span><span class="cls_005"><sup>1</sup></span><span class="cls_004"> and agent2.mp4</span><span class="cls_005"><sup>2</sup></span><span class="cls_004">.</span></div>
<div style="position:absolute;left:78.76px;top:201.82px" class="cls_004"><span class="cls_004">During the bulk of our development period, one team member worked on a controller using Reinforcement</span></div>
<div style="position:absolute;left:61.20px;top:216.65px" class="cls_004"><span class="cls_004">Learning (RL) and a defined policy.  Another person worked on developing the controller using the true loca-</span></div>
<div style="position:absolute;left:61.20px;top:231.49px" class="cls_004"><span class="cls_004">tions of key objects (x-dimension on a range of [−45.6, 45.6], y-dimension on a range of [−64.5, 64.5]).  A third</span></div>
<div style="position:absolute;left:61.20px;top:246.33px" class="cls_004"><span class="cls_004">person developed code to pull training data based on the controller, while the final person worked on an Fully</span></div>
<div style="position:absolute;left:61.20px;top:261.16px" class="cls_004"><span class="cls_004">Convolutional Network (FCN) that tried to predict true map coordinates.</span></div>
<div style="position:absolute;left:78.76px;top:276.00px" class="cls_004"><span class="cls_004">During early development, we struggled to find the correct transformation for coordinates in the kart’s field</span></div>
<div style="position:absolute;left:61.20px;top:290.84px" class="cls_004"><span class="cls_004">of view into actual map coordinates because the vision of the kart is not in bird’s eye view.  This hindered</span></div>
<div style="position:absolute;left:61.20px;top:305.67px" class="cls_004"><span class="cls_004">the accuracy of our FCN and with one week remaining, we began concentrating on a solution that relied on</span></div>
<div style="position:absolute;left:61.20px;top:320.51px" class="cls_004"><span class="cls_004">coordinates relative to the kart instead (herein, image coordinate).</span></div>
<div style="position:absolute;left:78.76px;top:335.34px" class="cls_004"><span class="cls_004">After switching to image coordinates, we quickly realized the  to image function given in Homework 5 to</span></div>
<div style="position:absolute;left:61.20px;top:350.18px" class="cls_004"><span class="cls_004">output image coordinates was insufficient for our final solution. When the puck is out of the kart’s field of view,</span></div>
<div style="position:absolute;left:61.20px;top:365.02px" class="cls_004"><span class="cls_004">the projected point from  to image became the coordinate mirrored along the x-axis. Thus, we decided to use a</span></div>
<div style="position:absolute;left:61.20px;top:379.85px" class="cls_004"><span class="cls_004">CNN to first identify if the puck is in the image. The controller only calls for the FCN predicted image coordinate</span></div>
<div style="position:absolute;left:61.20px;top:394.69px" class="cls_004"><span class="cls_004">if the CNN predicts that the puck is already in frame.</span></div>
<div style="position:absolute;left:78.76px;top:409.53px" class="cls_004"><span class="cls_004">During final stages in development, we struggled with finding the balance in the trade-off between run-time and</span></div>
<div style="position:absolute;left:61.20px;top:424.36px" class="cls_004"><span class="cls_004">accuracy. Our most accurate FCN model was 10x slower than the Homework 5 master solution. To troubleshoot,</span></div>
<div style="position:absolute;left:61.20px;top:439.20px" class="cls_004"><span class="cls_004">one teammate attempted to reduce the two-model solution while another teammate created a model that would</span></div>
<div style="position:absolute;left:61.20px;top:454.03px" class="cls_004"><span class="cls_004">predict both presence and location of the puck by balancing two loss functions in a way similar to Homework</span></div>
<div style="position:absolute;left:61.20px;top:468.87px" class="cls_004"><span class="cls_004">4.  The latter was not selected due to low validation accuracy. We also grappled with finding a balanced set of</span></div>
<div style="position:absolute;left:61.20px;top:483.71px" class="cls_004"><span class="cls_004">training images for our CNN so that our model would have examples the puck at many different states and at</span></div>
<div style="position:absolute;left:61.20px;top:498.54px" class="cls_004"><span class="cls_004">many different distances from the kart. In the end, we introduced used AI at various difficulty levels and several</span></div>
<div style="position:absolute;left:61.20px;top:513.38px" class="cls_004"><span class="cls_004">controllers to pull the training data that yielded our final models.</span></div>
<div style="position:absolute;left:61.20px;top:544.95px" class="cls_003"><span class="cls_003">2</span></div>
<div style="position:absolute;left:81.37px;top:544.95px" class="cls_003"><span class="cls_003">Model and Strategy</span></div>
<div style="position:absolute;left:61.20px;top:571.64px" class="cls_004"><span class="cls_004">Our submitted project uses a CNN trained on render data[i].instance and the puck’s in-game object ID to</span></div>
<div style="position:absolute;left:61.20px;top:586.48px" class="cls_004"><span class="cls_004">identify if the puck is in the field of view, and a FCN with 4 layers, 2 conv2d-batchnorm-relu blocks per layer</span></div>
<div style="position:absolute;left:61.20px;top:601.31px" class="cls_004"><span class="cls_004">used from Homework 5 to predict the [−1, 1] image coordinate if the puck is in the driver’s field of view.</span></div>
<div style="position:absolute;left:78.76px;top:616.15px" class="cls_004"><span class="cls_004">The controller uses the x-coordinate of the predicted image coordinate to steer. The driver accelerates less</span></div>
<div style="position:absolute;left:61.20px;top:630.99px" class="cls_004"><span class="cls_004">if the puck is sufficiently close to him. If the puck is very close to the driver, he stops using the FCN-predicted</span></div>
<div style="position:absolute;left:61.20px;top:645.82px" class="cls_004"><span class="cls_004">aim point to steer, and instead, uses the angle between two vectors: the vector from the kart to the puck, and</span></div>
<div style="position:absolute;left:61.20px;top:660.66px" class="cls_004"><span class="cls_004">the vector from the kart to the goal. The angle between these two vectors is calculated using the following and</span></div>
<div style="position:absolute;left:74.66px;top:681.10px" class="cls_005"><span class="cls_005"><sup>1</sup></span><A HREF="https://drive.google.com/file/d/1xrA3_yvkM8DrOWpGMjObvHlrTzD8W2b3/view?usp=sharing">https://drive.google.com/file/d/1xrA3_yvkM8DrOWpGMjObvHlrTzD8W2b3/view?usp=sharing</A> </span></div>
<div style="position:absolute;left:74.66px;top:693.05px" class="cls_005"><span class="cls_005"><sup>2</sup></span><A HREF="https://drive.google.com/file/d/1OadCLRZ_2bJweniyaXHfqKEJ9a5A7x4s/view?usp=sharing">https://drive.google.com/file/d/1OadCLRZ_2bJweniyaXHfqKEJ9a5A7x4s/view?usp=sharing</A> </span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:802px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="10a4fa4e-3278-11ec-a980-0cc47a792c0a_id_10a4fa4e-3278-11ec-a980-0cc47a792c0a_files/background2.jpg" width=612 height=792></div>
<div style="position:absolute;left:61.20px;top:63.19px" class="cls_004"><span class="cls_004">multiplied by -1 if the v2 is to the left of v1:</span></div>
<div style="position:absolute;left:307.10px;top:78.89px" class="cls_004"><span class="cls_004">(</span></div>
<div style="position:absolute;left:366.50px;top:78.89px" class="cls_004"><span class="cls_004">)</span></div>
<div style="position:absolute;left:257.60px;top:86.20px" class="cls_004"><span class="cls_004">π</span></div>
<div style="position:absolute;left:326.70px;top:86.20px" class="cls_004"><span class="cls_004">v1 · v2</span></div>
<div style="position:absolute;left:238.17px;top:92.94px" class="cls_004"><span class="cls_004">θ=</span></div>
<div style="position:absolute;left:258.13px;top:92.94px" class="cls_004"><span class="cls_004">2 −arcsin</span></div>
<div style="position:absolute;left:315.63px;top:99.77px" class="cls_004"><span class="cls_004">||v1|| · ||v2||</span></div>
<div style="position:absolute;left:78.76px;top:122.68px" class="cls_004"><span class="cls_004">If the puck is predicted to not be in the kart’s field of view, the kart begins backing up and spinning around to</span></div>
<div style="position:absolute;left:61.20px;top:137.52px" class="cls_004"><span class="cls_004">find the puck. Also, when the puck is out of sight, rescue is implemented with probability following Bin(p = 0.01)</span></div>
<div style="position:absolute;left:61.20px;top:152.35px" class="cls_004"><span class="cls_004">to avoid the kart getting stuck anywhere.</span></div>
<div style="position:absolute;left:61.20px;top:183.92px" class="cls_003"><span class="cls_003">3</span></div>
<div style="position:absolute;left:81.37px;top:183.92px" class="cls_003"><span class="cls_003">Other Attempted Strategies</span></div>
<div style="position:absolute;left:61.20px;top:210.61px" class="cls_004"><span class="cls_004">Our main competing strategy was using reinforcement learning based on a defined policy.</span></div>
<div style="position:absolute;left:78.76px;top:225.45px" class="cls_004"><span class="cls_004">The first implementation of reinforcement learning we attempted relies on an aim point generated using a</span></div>
<div style="position:absolute;left:61.20px;top:240.28px" class="cls_004"><span class="cls_004">FCN model which provides the relative position of the puck on the field-of-view image provided by the kart. The</span></div>
<div style="position:absolute;left:61.20px;top:255.12px" class="cls_004"><span class="cls_004">reinforcement learning agent is guided by a linear model which takes as input a tensor of shape 1 × 3 and includes</span></div>
<div style="position:absolute;left:61.20px;top:269.96px" class="cls_004"><span class="cls_004">the x and y coordinates along with the velocity of the kart. The model outputs the probability of braking and</span></div>
<div style="position:absolute;left:61.20px;top:284.79px" class="cls_004"><span class="cls_004">the probability of steering in a specific direction. The second implementation used a CNN model similar to the</span></div>
<div style="position:absolute;left:61.20px;top:299.63px" class="cls_004"><span class="cls_004">one provided to us as a solution to Homework 3. The third implementation used a FCN model similar to the one</span></div>
<div style="position:absolute;left:61.20px;top:314.47px" class="cls_004"><span class="cls_004">provided to us as a solution to Homework 4.  Both models take as input the field-of-view image from the kart</span></div>
<div style="position:absolute;left:61.20px;top:329.30px" class="cls_004"><span class="cls_004">and similar to the aim-point implementation, both the CNN and FCN implementation output the probability of</span></div>
<div style="position:absolute;left:61.20px;top:344.14px" class="cls_004"><span class="cls_004">braking and the probability of steering in a specific direction.</span></div>
<div style="position:absolute;left:78.76px;top:358.98px" class="cls_004"><span class="cls_004">All implementations were tested using the same number of episodes, maximum number of steps per episode,</span></div>
<div style="position:absolute;left:61.20px;top:373.81px" class="cls_004"><span class="cls_004">opposition agents and rewards function.  The agent was encouraged to move towards the puck and move the</span></div>
<div style="position:absolute;left:61.20px;top:388.65px" class="cls_004"><span class="cls_004">puck towards the goal with a positive reward and discouraged to move away from the puck and move the puck</span></div>
<div style="position:absolute;left:61.20px;top:403.48px" class="cls_004"><span class="cls_004">away from the goal with a negative reward. Unfortunately, all implementations were unable to consistently score</span></div>
<div style="position:absolute;left:61.20px;top:418.32px" class="cls_004"><span class="cls_004">a goal.  We attempted numerous techniques to enable faster learning for the agent.  We removed the AI agent</span></div>
<div style="position:absolute;left:61.20px;top:433.16px" class="cls_004"><span class="cls_004">as the opposition in order to remove variance during the learning process. For each episode, we tried randomly</span></div>
<div style="position:absolute;left:61.20px;top:447.99px" class="cls_004"><span class="cls_004">initializing the location of the kart to help generalize the solution. We also trained the agent after removing the</span></div>
<div style="position:absolute;left:61.20px;top:462.83px" class="cls_004"><span class="cls_004">braking probability output and noticed improved results. The drawback of this solution was the kart’s inability</span></div>
<div style="position:absolute;left:61.20px;top:477.67px" class="cls_004"><span class="cls_004">to escape when stuck next to a wall.</span></div>
<div style="position:absolute;left:61.20px;top:509.23px" class="cls_003"><span class="cls_003">4</span></div>
<div style="position:absolute;left:81.37px;top:509.23px" class="cls_003"><span class="cls_003">Future Steps</span></div>
<div style="position:absolute;left:61.20px;top:535.93px" class="cls_004"><span class="cls_004">If we had more time, we would’ve like to develop our controller more. One issue that is unresolved is how to deal</span></div>
<div style="position:absolute;left:61.20px;top:550.76px" class="cls_004"><span class="cls_004">with the puck when it’s very close to our own goal. We struggled to find an aim point that is between the puck</span></div>
<div style="position:absolute;left:61.20px;top:565.60px" class="cls_004"><span class="cls_004">and our own net. As a result, instead of driving to a point where we can push the puck away from our own net,</span></div>
<div style="position:absolute;left:61.20px;top:580.44px" class="cls_004"><span class="cls_004">we just aim directly at the puck and thus, cannot prevent our players from scoring on our own goal.</span></div>
<div style="position:absolute;left:78.76px;top:595.27px" class="cls_004"><span class="cls_004">A future step to improve upon our current strategy is to employ a defense role:  one main shooter player</span></div>
<div style="position:absolute;left:61.20px;top:610.11px" class="cls_004"><span class="cls_004">and supporting defense player. The supporting player can pick up items and try to sabotage the opposing team.</span></div>
<div style="position:absolute;left:61.20px;top:624.94px" class="cls_004"><span class="cls_004">This would required additional FCNs that identify enemy players and items to pick up. Having this supporting</span></div>
<div style="position:absolute;left:61.20px;top:639.78px" class="cls_004"><span class="cls_004">player could help crowd out the playing field when the main player is attempting to gain control of the puck.</span></div>
<div style="position:absolute;left:61.20px;top:654.62px" class="cls_004"><span class="cls_004">Unfortunately, we ran out of time before we could try to implement this supporting player.</span></div>
<div style="position:absolute;left:78.76px;top:669.45px" class="cls_004"><span class="cls_004">Moving forward, we hope to continue to learn more about how the development of solutions in real life, like</span></div>
<div style="position:absolute;left:61.20px;top:684.29px" class="cls_004"><span class="cls_004">the self-driving car, integrate both vision and imitation learning into their models.</span></div>
<div style="position:absolute;left:303.07px;top:748.73px" class="cls_003"><span class="cls_003">2</span></div>
</div>

</body>
</html>
